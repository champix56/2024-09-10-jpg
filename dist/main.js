(()=>{"use strict";var e={962:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(601),o=n.n(i),r=n(314),a=n.n(r)()(o());a.push([e.id,"#meme-editor{\n    display: flex;    \n}\n#meme-viewer{\n    flex-grow: 1;\n    padding: 10px;\n    height: 100%;\n    display: flex;\n    justify-content: space-around;\n}\n#meme-viewer>svg{\n    max-height: 100%;\n}\n#meme-form{\n    padding: 5px 10px;\n    text-align: center;\n}\nform label{\n    display: block;\n}\n.cols_2, .cols_3, .cols{\n    display: flex;\n    justify-content: space-between;\n}\n.cols_3>*{\n    width:31%;\n    text-align: center;\n}\n.cols_2>*{\n    width:48%;\n    text-align: center;\n}\n.cols_2>* input{\n    max-width: 80px;\n}\n.center{\n    text-align: center;\n}",""]);const s=a},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,o,r){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(a[d]=!0)}for(var l=0;l<e.length;l++){var m=[].concat(e[l]);i&&a[m[0]]||(void 0!==r&&(void 0===m[5]||(m[1]="@layer".concat(m[5].length>0?" ".concat(m[5]):""," {").concat(m[1],"}")),m[5]=r),n&&(m[2]?(m[1]="@media ".concat(m[2]," {").concat(m[1],"}"),m[2]=n):m[2]=n),o&&(m[4]?(m[1]="@supports (".concat(m[4],") {").concat(m[1],"}"),m[4]=o):m[4]="".concat(o)),t.push(m))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var r={},a=[],s=0;s<e.length;s++){var d=e[s],l=i.base?d[0]+i.base:d[0],m=r[l]||0,c="".concat(l," ").concat(m);r[l]=m+1;var u=n(c),h={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==u)t[u].references++,t[u].updater(h);else{var p=o(h,i);i.byIndex=s,t.splice(s,0,{identifier:c,updater:p,references:1})}a.push(c)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var r=i(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<r.length;a++){var s=n(r[a]);t[s].references--}for(var d=i(e,o),l=0;l<r.length;l++){var m=n(r[l]);0===t[m].references&&(t[m].updater(),t.splice(m,1))}r=d}}},659:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;const i=Object.freeze({memes:"/memes",images:"/images"}),o="http://localhost:5629",r=new class extends Array{promise=void 0;constructor(){super()}loadingAll(){this.splice(0),this.promise=fetch(`${o}${i.images}`).then((e=>e.json())),this.promise.then((e=>{this.push(...e)}))}findImageById(e){return super.find((t=>t.id===e))}};r.loadingAll();class a{id;titre="";text="";x=0;y=0;fontWeight=500;fontSize=12;underline=!1;italic=!0;imageId=-1;color="#0";frameSizeX=0;frameSizeY=0;constructor(e){void 0!==e&&Object.assign(this,e)}save(){const e=fetch(`${o}${i.memes}${void 0!==this.id?`/${this.id}`:""}`,{headers:{"Content-Type":"application/json",Accept:"application/json"},method:void 0!==this.id?"PUT":"POST",body:JSON.stringify(this)}).then((e=>e.json()));return e.then((e=>Object.assign(this,e))),e}static load(e){return fetch(`${o}${i.memes}/${e}`).then((e=>e.ok?e.json():void console.log("REST404 : meme not found at adr:"+e.url))).then((e=>{if(void 0!==e)return new a(e)}))}getImageInMeme(){return r.findImageById(this.imageId)}}var s=n(72),d=n.n(s),l=n(825),m=n.n(l),c=n(659),u=n.n(c),h=n(56),p=n.n(h),v=n(540),f=n.n(v),g=n(113),y=n.n(g),b=n(962),x={};x.styleTagTransform=y(),x.setAttributes=p(),x.insert=u().bind(null,"head"),x.domAPI=m(),x.insertStyleElement=f(),d()(b.A,x),b.A&&b.A.locals&&b.A.locals;const S=new class extends Array{promise=void 0;constructor(){super()}loadingAll(){return this.splice(0),this.promise=fetch(`${o}${i.memes}`).then((e=>e.json())).then((e=>{e.map((e=>{this.push(new a(e))}))})),this.promise}findMemeById(e){return super.find((t=>t.id===e))}find(){console.error("find interdit")}};S.loadingAll();class N{templateuri="";domNodeWhereMount="";domNodeLoaded=void 0;promise=void 0;constructor(e,t){this.templateuri=e,this.domNodeWhereMount=t}loadTemplate=(e,t)=>(void 0===this.promise&&(this.promise=fetch(this.templateuri).then((e=>e.text())).then((e=>(this.domNodeLoaded=document.createElement("div"),this.domNodeLoaded.innerHTML=e,this.domNodeLoaded=this.domNodeLoaded.firstChild,t(this.domNodeLoaded),e)))),this.promise.then((e=>(this.domNodeWhereMount.innerHTML="",this.domNodeWhereMount.appendChild(this.domNodeLoaded),this.domNodeWhereMount))))}const M=[{name:"meme",path:/meme(\/(?<id>\d+))?$/,title:"Edition de meme",manager:new class{#e=void 0;#t=void 0;#n=void 0;#i=e=>{this.#n[e.target.name]=Number(e.target.value),this.#o()};#r=e=>{this.#n[e.target.name]=e.target.value,this.#o()};#a=e=>{this.#n[e.target.name]=e.target.checked,this.#o()};#s=()=>{this.#e.querySelector("form").addEventListener("submit",(e=>{e.preventDefault(),console.log("%c%s","color:red;font-size:32pt","Formulaire valider")})),this.#e.querySelectorAll("input, select").forEach((e=>{switch(e.name){case"font-size":case"x":case"y":e.addEventListener("input",this.#i);break;case"imageId":e.addEventListener("change",this.#i);break;case"underline":e.addEventListener("change",this.#a);break;default:e.addEventListener("input",this.#r)}}))};#o=()=>{const e=this.#e.querySelector("svg"),t=e.querySelector("text");t.attributes.x.value=this.#n.x,t.attributes.y.value=this.#n.y,t.attributes["font-size"].value=this.#n.fontSize,t.attributes["font-weight"].value=this.#n.fontWeight,t.attributes.fill.value=this.#n.color,t.attributes["text-decoration"].value=this.#n.underline?"underline":"normal",t.innerHTML=this.#n.text;const n=this.#n.getImageInMeme();e.attributes.viewBox.value=`0 0 ${void 0!==n?n.w:1e3} ${void 0!==n?n.h:1e3}`;const i=e.querySelector("image");n?(i.style.display="block",i.attributes["xlink:href"].value=n.url):i.style.display="none"};loadMeme=e=>{this.#n=e,this.#e.querySelector("input[name=text]").value=e.text,this.#e.querySelector("input[name=x]").value=e.x,this.#e.querySelector("input[name=y]").value=e.y,this.#e.querySelector("select[name=imageId]").value=e.imageId,this.#e.querySelector("input[name=fontWeight]").value=e.fontWeight,this.#e.querySelector("input[name=fontSize]").value=e.fontSize,this.#e.querySelector("input[name=color]").value=e.color,this.#e.querySelector("input[name=titre]").value=e.titre,this.#e.querySelector("input[name=italic]").value=e.italic.toString(),this.#e.querySelector("input[name=underline]").checked=e.underline,this.#o()};#d=()=>{const e=this.#e.querySelector("select"),t=e.querySelector("option");e.innerHTML="",e.appendChild(t),r.map((n=>{const i=t.cloneNode(!0);i.value=n.id,i.innerHTML=n.name,e.appendChild(i)}))};loadTemplate(e){void 0===this.#t&&(this.#t=fetch("/templates/MemeEditor/MemeEditor.html").then((e=>e.text())).then((e=>{const t=document.createElement("div");return t.innerHTML=e,this.#e=t.firstChild,this.#s(),e}))),this.#t=this.#t.then((()=>{const e=document.querySelector("#main");e.innerHTML="",e.appendChild(this.#e)}));const t=[this.#t,r.promise];if(void 0!==e&&void 0!==e.id){const n=Number(e.id);if(NaN===n)return router.navigate("/");const i=a.load(n).then((e=>(void 0===e&&router.navigate("/"),this.#n=e,this.#n)));t.push(i)}else this.#n=new a;Promise.all(t).then((e=>{this.#d(),this.loadMeme(this.#n)}))}}},{name:"memes",path:/memes\/?$/,title:"liste des memes dans le serveur",manager:new class{#t=void 0;#e=void 0;constructor(){}loadTemplate(e,t){void 0===this.#t&&(this.#t=fetch("/templates/MemeThumbnail/MemeThumbnail.html").then((e=>e.text())).then((e=>{const t=document.createElement("div");return t.innerHTML=e,this.#e=t.firstChild,e}))),this.#t=this.#t.then((()=>{const e=document.querySelector("#main");e.innerHTML="",e.appendChild(this.#e)}));const n=[this.#t,r.promise,S.promise];Promise.all(n).then((e=>{this.constructThumbnail(),t(this.#e)}))}constructThumbnail=()=>{const e=this.#e.querySelector("#meme-");S.map((t=>{const n=e.cloneNode(!0);n.querySelector("a").href="/meme/"+t.id,n.querySelector(".title-link").innerHTML=t.titre;const i=n.querySelector("svg"),o=i.querySelector("text");o.attributes.x.value=t.x,o.attributes.y.value=t.y,o.attributes["font-size"].value=t.fontSize,o.attributes["font-weight"].value=t.fontWeight,o.attributes.fill.value=t.color,o.attributes["text-decoration"].value=t.underline?"underline":"normal",o.innerHTML=t.text;const r=t.getImageInMeme();i.attributes.viewBox.value=`0 0 ${void 0!==r?r.w:1e3} ${void 0!==r?r.h:1e3}`;const a=i.querySelector("image");r?(a.style.display="block",a.attributes["xlink:href"].value=r.url):a.style.display="none",n.style.display="block",this.#e.appendChild(n)}))}}},{name:"credits",path:/credits\/?$/,templateUrl:"/templates/credits/credits.html",title:"remerciements"},{name:"default",template:"<h1>Bonjour &amp; bienvenue</h1><p>l'editeur de meme nouvelle generation en SVG</p>",title:"home"}],w=new class{#l;constructor(e){this.#l=e}constructPage=e=>{let t;this.#l=e;const n=M.find((e=>{if("default"===e.name)return!0;const n=e.path;return t=n.exec(location.pathname),null!==t}));console.log(n),void 0!==n.manager?n.manager.loadTemplate(t.groups,w.routerLinkEventBinding):void 0!==n.templateUrl?(n.manager=new N(n.templateUrl,e),n.manager.loadTemplate(void 0,(()=>{}))):void 0!==n.template&&(this.#l.innerHTML=n.template)};navigate=e=>{history.pushState(null,null,e),this.constructPage(this.#l)};routerLinkEventBinding=e=>{e.querySelectorAll("a").forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),e.querySelectorAll("a.active").forEach((e=>e.classList.remove("active"))),t.target.classList.add("active"),this.navigate(t.target.href)}))}))}},L=w;document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#navbar");new N("/templates/navbar/navbar.html",e).loadTemplate(void 0,L.routerLinkEventBinding),L.constructPage(document.querySelector("#main"))})),window.router=L})();